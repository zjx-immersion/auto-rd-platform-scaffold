# 需求三层模型设计方案 V2

**创建日期**: 2026-01-28  
**分支**: feature/mvp-req-to-iteration  
**版本**: V2.0（根据实际业务流程重新设计）

---

## 🎯 设计目标

实现符合汽车行业的三层需求管理模型：
1. **需求池管理**：Epic管理 + FIP导入
2. **特性需求管理**：产品线-产品-Feature-SSTS层级
3. **模块需求管理**：SSTS→MR拆解 + Module预管理
4. **迭代工作票**：统一的工作票（Ticket）系统

---

## 📊 核心业务模型

### 整体架构

```
需求池（Requirement Pool）
├── Epic池（自管理）
│   ├── 用户需求
│   ├── 市场反馈
│   └── 创新需求
└── FIP表（导入管理）
    ├── 导入Excel
    ├── 表格查看
    ├── 标注修改意见
    └── 导出

↓ 拆解

产品线（Product Line）
└── 产品（Product）
    └── 特性需求（Feature）
        ├── 基本信息（版本信息）
        ├── 设计文档（PRD、需求文档）
        └── SSTS列表（每个有版本）

↓ 拆解

模块（Module）- 预先建立
└── 模块需求（MR）
    ├── 基本信息
    ├── 接口设计
    └── 实现方案

↓ 转入迭代

Sprint（迭代）
└── 工作票（Ticket）
    ├── MR需求票
    ├── Bugfix票
    ├── 风险票
    ├── 依赖票
    └── 技术任务票
```

---

## 🗂️ 数据模型设计

### 1. 需求池（Requirement Pool）

#### 1.1 Epic（史诗需求）

```typescript
export enum EpicSource {
  USER_REQUIREMENT = 'USER_REQUIREMENT', // 用户需求
  MARKET_FEEDBACK = 'MARKET_FEEDBACK', // 市场反馈
  INNOVATION = 'INNOVATION', // 创新需求
  INTERNAL = 'INTERNAL', // 内部需求
  COMPETITION = 'COMPETITION', // 竞品分析
}

export enum EpicStatus {
  POOL = 'POOL', // 需求池中
  EVALUATING = 'EVALUATING', // 评估中
  APPROVED = 'APPROVED', // 已批准
  IN_PROGRESS = 'IN_PROGRESS', // 进行中
  COMPLETED = 'COMPLETED', // 已完成
  REJECTED = 'REJECTED', // 已拒绝
  CANCELLED = 'CANCELLED', // 已取消
}

export interface Epic extends BaseEntity {
  // 基本信息
  title: string
  code: string // EPIC-2024-001
  description: string
  source: EpicSource
  status: EpicStatus
  priority: Priority
  moscow: MoSCoW
  
  // 来源信息
  sourceDetail?: string // 来源详情（客户反馈、市场调研等）
  reporter?: string // 提出人
  reportDate?: string // 提出日期
  
  // 业务价值
  businessValue: string
  targetUsers: string[]
  marketSize?: string // 市场规模
  expectedRevenue?: number // 预期收益
  
  // 评估信息
  feasibilityScore: number // 可行性评分 0-100
  valueScore: number // 价值评分 0-100
  complexityScore: number // 复杂度评分 0-100
  
  // 关联
  productLineId?: string // 所属产品线
  featureIds: string[] // 拆解出的Feature
  
  // 统计
  featureCount: number
  totalStoryPoints: number
  
  // 备注
  notes?: string
  attachments: string[] // 附件URL
}
```

#### 1.2 FIP表（Feature Import Pool）

```typescript
export enum FIPStatus {
  IMPORTED = 'IMPORTED', // 已导入
  UNDER_REVIEW = 'UNDER_REVIEW', // 审查中
  APPROVED = 'APPROVED', // 已批准
  REJECTED = 'REJECTED', // 已拒绝
  CONVERTED = 'CONVERTED', // 已转换为Feature
}

export interface FIPRecord extends BaseEntity {
  // 导入信息
  importBatchId: string // 导入批次ID
  importDate: string
  importBy: string
  sourceFile: string // 源文件名
  
  // FIP表字段（根据实际FIP表结构定义）
  fipId: string // FIP编号
  featureName: string
  description: string
  priority: string
  targetRelease: string
  owner: string
  
  // 状态
  status: FIPStatus
  
  // 修改意见（只能标注，不能直接修改）
  annotations: FIPAnnotation[]
  
  // 转换
  convertedToFeatureId?: string // 转换后的Feature ID
  convertedAt?: string
  convertedBy?: string
}

export interface FIPAnnotation {
  id: string
  fieldName: string // 标注的字段
  annotationType: 'CORRECTION' | 'CLARIFICATION' | 'QUESTION'
  content: string // 标注内容
  annotatedBy: string
  annotatedAt: string
  resolved: boolean
}

export interface FIPImportBatch {
  id: string
  fileName: string
  importDate: string
  importBy: string
  totalRecords: number
  successCount: number
  errorCount: number
  status: 'PROCESSING' | 'COMPLETED' | 'FAILED'
  errors: string[]
}
```

---

### 2. 特性需求（Feature）

```typescript
export interface Feature extends BaseEntity {
  // 基本信息
  name: string
  code: string // FEAT-2024-001
  description: string
  version: string // v1.0.0
  
  // 关联
  epicId?: string // 来自Epic
  fipRecordId?: string // 来自FIP导入
  productLineId: string
  productId: string
  
  // 层级信息
  parentFeatureId?: string // 父Feature（如果有子Feature）
  
  // 状态
  status: FeatureStatus
  priority: Priority
  moscow: MoSCoW
  
  // 负责人
  featureOwnerId: string // FO - Feature Owner
  
  // 设计文档
  documents: FeatureDocument[]
  
  // SSTS列表
  sstsIds: string[]
  sstsCount: number
  
  // 版本管理
  versionHistory: FeatureVersion[]
  currentVersion: string
  
  // 统计
  totalStoryPoints: number
  completedStoryPoints: number
  maturity: number // 成熟度 0-100
  completeness: number // 完成度 0-100
  
  // 时间
  plannedStartDate?: string
  plannedEndDate?: string
  actualStartDate?: string
  actualEndDate?: string
}

export interface FeatureDocument {
  id: string
  type: 'PRD' | 'REQUIREMENT_SPEC' | 'USER_STORY' | 'USE_CASE' | 'OTHER'
  title: string
  content: string // 富文本或Markdown
  version: string
  author: string
  createdAt: string
  updatedAt: string
  status: 'DRAFT' | 'IN_REVIEW' | 'APPROVED'
  attachments: string[]
}

export interface FeatureVersion {
  version: string
  changeLog: string
  createdAt: string
  createdBy: string
  sstsSnapshot: string[] // 该版本的SSTS列表快照
}
```

---

### 3. SSTS（系统/子系统技术规范）

```typescript
export interface SSTS extends BaseEntity {
  name: string
  code: string // SSTS-2024-001
  description: string
  version: string // v1.0.0
  
  // 关联
  featureId: string
  
  // 类型
  type: SSTSType
  
  // 状态
  status: SSTSStatus
  priority: Priority
  
  // 规格
  functionalSpec?: string // 功能规格
  technicalSpec?: string // 技术规格
  performanceSpec?: string // 性能规格
  safetyLevel?: SafetyLevel
  
  // 验证
  verificationMethod: 'TEST' | 'ANALYSIS' | 'INSPECTION' | 'DEMONSTRATION'
  verificationCriteria?: string
  
  // MR列表
  mrIds: string[]
  mrCount: number
  
  // 版本管理
  versionHistory: SSTSVersion[]
  currentVersion: string
  
  // 负责人
  ownerId: string // SE或FO
  
  // 评审
  reviews: ApprovalRecord[]
  
  // 文档
  attachments: string[]
}

export interface SSTSVersion {
  version: string
  changeLog: string
  createdAt: string
  createdBy: string
  mrSnapshot: string[] // 该版本的MR列表快照
}
```

---

### 4. Module（模块）- 预先建立

```typescript
export interface Module extends BaseEntity {
  // 基本信息
  name: string
  code: string // MOD-ADAS-001
  description: string
  
  // 层级关系
  productLineId: string
  productId: string
  parentModuleId?: string // 父模块（支持模块树）
  
  // 分类
  category: ModuleCategory
  domain: 'ADAS' | 'CABIN' | 'EE' | 'CHASSIS' | 'POWERTRAIN'
  
  // 负责团队
  teamId: string
  moduleOwnerId: string // MO - Module Owner
  
  // 技术信息
  techStack: string[] // 技术栈
  dependencies: string[] // 依赖的Module IDs
  
  // 接口定义
  interfaces: ModuleInterface[]
  
  // 统计
  mrCount: number
  activeTicketCount: number
  
  // 状态
  status: 'ACTIVE' | 'DEPRECATED' | 'ARCHIVED'
}

export enum ModuleCategory {
  CORE = 'CORE', // 核心模块
  COMMON = 'COMMON', // 通用模块
  BUSINESS = 'BUSINESS', // 业务模块
  INFRASTRUCTURE = 'INFRASTRUCTURE', // 基础设施
  INTEGRATION = 'INTEGRATION', // 集成模块
}

export interface ModuleInterface {
  id: string
  name: string
  type: 'INPUT' | 'OUTPUT' | 'API' | 'EVENT' | 'SERVICE'
  protocol?: string
  dataFormat?: string
  description?: string
  version: string
}
```

---

### 5. MR（Module Requirement）

```typescript
export interface MR extends BaseEntity {
  name: string
  code: string // MR-2024-001
  description: string
  version: string // v1.0.0
  
  // 关联
  sstsId: string
  moduleId: string // 预先建立的Module
  
  // 状态
  status: MRStatus
  priority: Priority
  
  // 团队
  teamId: string
  assigneeId?: string // SO - System Owner
  
  // 接口设计
  interfaces: ModuleInterface[]
  
  // 工作量
  estimatedEffort: number // 人日
  actualEffort?: number
  
  // 资产复用
  reuseStrategy: ReuseStrategy
  reusedAssetId?: string
  reusedAssetVersion?: string
  effortSaved?: number
  
  // 就绪检查
  isReady: boolean
  readinessChecks: ReadinessCheck[]
  
  // 转换为工作票
  convertedToTicketId?: string
  convertedAt?: string
  
  // 评审
  reviews: ApprovalRecord[]
}

export enum MRStatus {
  DRAFT = 'DRAFT',
  IN_REVIEW = 'IN_REVIEW',
  APPROVED = 'APPROVED',
  READY_FOR_DEV = 'READY_FOR_DEV',
  CONVERTED_TO_TICKET = 'CONVERTED_TO_TICKET', // 已转为工作票
  COMPLETED = 'COMPLETED',
  CANCELLED = 'CANCELLED',
}
```

---

### 6. 工作票（Ticket）- 迭代执行单元

```typescript
export enum TicketType {
  MR_REQUIREMENT = 'MR_REQUIREMENT', // MR需求票
  BUG_FIX = 'BUG_FIX', // Bug修复票
  RISK = 'RISK', // 风险票
  DEPENDENCY = 'DEPENDENCY', // 依赖票
  TECHNICAL_TASK = 'TECHNICAL_TASK', // 技术任务票
  REFACTORING = 'REFACTORING', // 重构票
  RESEARCH = 'RESEARCH', // 技术调研票
  DEPLOYMENT = 'DEPLOYMENT', // 部署票
}

export enum TicketStatus {
  TODO = 'TODO',
  IN_PROGRESS = 'IN_PROGRESS',
  REVIEW = 'REVIEW',
  TESTING = 'TESTING',
  DONE = 'DONE',
  BLOCKED = 'BLOCKED',
  CANCELLED = 'CANCELLED',
}

export interface Ticket extends BaseEntity {
  // 基本信息
  title: string
  code: string // TKT-2024-001
  description: string
  type: TicketType
  
  // 关联
  sprintId: string
  mrId?: string // 如果是MR需求票
  moduleId: string
  epicId?: string
  featureId?: string
  sstsId?: string
  
  // 状态
  status: TicketStatus
  priority: Priority
  
  // 团队
  assigneeId: string
  reviewerId?: string
  teamId: string
  
  // 评估
  storyPoints?: number
  estimatedHours: number
  actualHours: number
  remainingHours: number
  progress: number
  
  // 依赖和阻塞
  dependsOn: string[] // 依赖的Ticket IDs
  blockedBy: string[] // 阻塞原因
  blockedReason?: string
  
  // 分类
  category: TaskCategory // 复用Task的分类
  tags: string[]
  
  // 时间
  plannedStartDate?: string
  plannedEndDate?: string
  actualStartDate?: string
  actualCompletedDate?: string
  
  // 技术细节
  technicalNotes?: string
  acceptanceCriteria?: string[]
  
  // 关联资源
  pullRequestUrl?: string
  branchName?: string
  commitHash?: string
  
  // 风险相关（如果type是RISK）
  riskLevel?: 'LOW' | 'MEDIUM' | 'HIGH' | 'CRITICAL'
  riskMitigation?: string
  
  // 依赖相关（如果type是DEPENDENCY）
  dependencyType?: 'INTERNAL' | 'EXTERNAL'
  dependencyOwner?: string
  dependencyStatus?: 'PENDING' | 'IN_PROGRESS' | 'RESOLVED'
}
```

---

## 🔄 业务流程设计

### 流程1: 需求池管理

```
A. Epic自管理流程
┌─────────────────────────────────────────┐
│ 1. 新建Epic                              │
│    - 选择来源（用户需求/市场反馈等）      │
│    - 填写基本信息                         │
│    - 描述业务价值                         │
│    - 添加附件                             │
├─────────────────────────────────────────┤
│ 2. Epic评估                              │
│    - 可行性评分                           │
│    - 价值评分                             │
│    - 复杂度评分                           │
│    - 评审会议                             │
├─────────────────────────────────────────┤
│ 3. 批准/拒绝                             │
│    - 已批准 → 准备拆解为Feature          │
│    - 已拒绝 → 记录原因，归档              │
└─────────────────────────────────────────┘

B. FIP导入流程
┌─────────────────────────────────────────┐
│ 1. 上传FIP Excel文件                     │
│    - 解析Excel                            │
│    - 验证数据格式                         │
│    - 创建导入批次                         │
├─────────────────────────────────────────┤
│ 2. 表格查看                              │
│    - 列表视图                             │
│    - 详情查看                             │
│    - 不可直接编辑                         │
├─────────────────────────────────────────┤
│ 3. 标注修改意见                          │
│    - 点击字段添加标注                     │
│    - 标注类型：纠正/澄清/疑问              │
│    - 记录标注人和时间                     │
├─────────────────────────────────────────┤
│ 4. 导出                                  │
│    - 原始数据 + 标注意见                  │
│    - Excel格式导出                        │
├─────────────────────────────────────────┤
│ 5. 转换为Feature（可选）                 │
│    - 选择FIP记录                          │
│    - 转换为正式Feature                    │
│    - 建立关联关系                         │
└─────────────────────────────────────────┘
```

### 流程2: 特性需求拆解

```
┌─────────────────────────────────────────┐
│ 1. 从Epic或FIP创建Feature                │
│    - 选择产品线和产品                     │
│    - 填写基本信息                         │
│    - 设置版本号（v1.0.0）                 │
├─────────────────────────────────────────┤
│ 2. 编写设计文档                          │
│    - 创建PRD                              │
│    - 创建需求规格说明                     │
│    - 添加用户故事                         │
│    - 上传附件                             │
├─────────────────────────────────────────┤
│ 3. 拆解SSTS                              │
│    - 点击"拆解SSTS"                       │
│    - 创建SSTS列表                         │
│    - 每个SSTS设置版本号                   │
│    - 定义规格和验证方法                   │
├─────────────────────────────────────────┤
│ 4. 版本管理                              │
│    - 记录变更历史                         │
│    - 版本快照                             │
│    - 变更日志                             │
└─────────────────────────────────────────┘
```

### 流程3: 模块需求拆解

```
前置条件：Module已预先建立
┌─────────────────────────────────────────┐
│ 1. 查看产品线-产品-模块树                 │
│    - 三级树形结构                         │
│    - 显示模块信息                         │
│    - 查看接口定义                         │
├─────────────────────────────────────────┤
│ 2. 从SSTS创建MR                          │
│    - 选择SSTS                             │
│    - 选择目标Module                       │
│    - 填写MR信息                           │
│    - 定义接口                             │
│    - 评估工作量                           │
├─────────────────────────────────────────┤
│ 3. 资产复用评估                          │
│    - 搜索可复用资产                       │
│    - 评估复用策略                         │
│    - 计算节省工作量                       │
├─────────────────────────────────────────┤
│ 4. 就绪检查                              │
│    - 接口定义完整                         │
│    - 依赖明确                             │
│    - 工作量评估                           │
│    - 标记为"Ready for Dev"                │
└─────────────────────────────────────────┘
```

### 流程4: 迭代工作票管理

```
┌─────────────────────────────────────────┐
│ 1. 转换MR为工作票                        │
│    - 选择Ready的MR                        │
│    - 创建MR需求票                         │
│    - 分配到Sprint                         │
│    - 关联Module和团队                     │
├─────────────────────────────────────────┤
│ 2. 创建其他类型工作票                    │
│    - Bug修复票（从缺陷管理）              │
│    - 风险票（风险识别）                   │
│    - 依赖票（依赖管理）                   │
│    - 技术任务票（技术债务）               │
├─────────────────────────────────────────┤
│ 3. Sprint Backlog管理                    │
│    - 查看所有工作票                       │
│    - 按类型分组                           │
│    - 拖拽排序优先级                       │
│    - 分配给开发人员                       │
├─────────────────────────────────────────┤
│ 4. 看板执行                              │
│    - Todo → In Progress → Review → Done  │
│    - 拖拽改变状态                         │
│    - 更新进度                             │
│    - 记录工时                             │
├─────────────────────────────────────────┤
│ 5. 状态同步                              │
│    - 工作票Done → MR状态更新              │
│    - MR完成 → SSTS进度更新                │
│    - SSTS完成 → Feature进度更新           │
│    - Feature完成 → Epic进度更新           │
└─────────────────────────────────────────┘
```

---

## 🎨 页面结构设计

### 模块A: 需求池管理

```
/requirements-pool
├── /epic-pool - Epic池管理
│   ├── 列表视图（按来源分组）
│   │   ├── 用户需求
│   │   ├── 市场反馈
│   │   └── 创新需求
│   ├── Epic详情
│   │   ├── 基本信息
│   │   ├── 评估信息
│   │   └── 拆解为Feature
│   └── 创建Epic
└── /fip-import - FIP导入管理
    ├── 导入界面
    │   └── 上传Excel文件
    ├── 导入批次列表
    ├── FIP记录列表（表格视图）
    │   ├── 只读查看
    │   ├── 标注功能
    │   └── 导出功能
    └── FIP记录详情
        ├── 字段详情
        ├── 标注列表
        └── 转换为Feature
```

### 模块B: 产品线-产品-特性需求

```
/product-lines
└── /:productLineId/products
    └── /:productId/features
        ├── Feature列表
        │   ├── 按状态筛选
        │   ├── 按版本筛选
        │   └── 搜索
        └── /:featureId
            ├── 概览Tab
            │   ├── 基本信息
            │   ├── 版本信息
            │   └── 统计数据
            ├── 设计文档Tab⭐
            │   ├── PRD
            │   ├── 需求规格
            │   ├── 用户故事
            │   └── 文档编辑器
            ├── SSTS列表Tab⭐
            │   ├── SSTS列表
            │   ├── 创建SSTS
            │   ├── SSTS详情
            │   └── 版本管理
            └── 版本历史Tab
                ├── 版本列表
                ├── 变更日志
                └── 版本对比
```

### 模块C: 模块管理

```
/modules
├── /tree - 模块树管理⭐
│   └── 产品线-产品-模块 三级树
│       ├── 树形视图
│       ├── 创建模块
│       ├── 编辑模块
│       └── 模块详情
│           ├── 基本信息
│           ├── 接口定义
│           ├── 依赖关系
│           └── MR列表
└── /:moduleId
    ├── 概览
    ├── MR列表
    ├── 工作票列表
    └── 团队信息
```

### 模块D: SSTS-MR管理

```
/ssts
└── /:sstsId
    ├── 概览
    │   ├── 基本信息
    │   ├── 规格说明
    │   └── 验证方法
    ├── MR拆解Tab⭐
    │   ├── MR列表
    │   ├── 创建MR按钮
    │   │   ├── 选择Module
    │   │   ├── 填写MR信息
    │   │   ├── 定义接口
    │   │   └── 评估工作量
    │   ├── MR详情
    │   └── 就绪检查
    └── 版本管理Tab
```

### 模块E: 迭代工作票

```
/sprints
└── /:sprintId
    ├── 概览Tab
    │   ├── Sprint信息
    │   ├── 统计数据
    │   └── 燃尽图
    ├── Backlog Tab⭐
    │   ├── 待分配工作票池
    │   │   ├── Ready的MR列表
    │   │   ├── 其他工作票
    │   │   └── 拖拽分配到Sprint
    │   ├── Sprint工作票列表
    │   │   ├── 按类型分组
    │   │   │   ├── MR需求票
    │   │   │   ├── Bug修复票
    │   │   │   ├── 风险票
    │   │   │   ├── 依赖票
    │   │   │   └── 技术任务票
    │   │   ├── 拖拽排序
    │   │   └── 批量操作
    │   └── 创建工作票
    │       ├── 选择类型
    │       ├── 关联MR（可选）
    │       └── 填写信息
    ├── 看板Tab⭐
    │   ├── 列布局
    │   │   ├── Todo列
    │   │   ├── In Progress列
    │   │   ├── Review列
    │   │   ├── Testing列
    │   │   └── Done列
    │   ├── 工作票卡片
    │   │   ├── 类型图标
    │   │   ├── 标题
    │   │   ├── 工时信息
    │   │   ├── 负责人
    │   │   └── 优先级
    │   ├── 拖拽移动
    │   └── 筛选器
    │       ├── 按类型
    │       ├── 按负责人
    │       └── 按Module
    └── 燃尽图Tab
        ├── Story Points燃尽图
        ├── 工时燃尽图
        └── 统计数据
```

---

## 📊 核心交互设计

### 交互1: FIP导入和标注

```
┌─────────────────────────────────────────┐
│ FIP导入管理                              │
│ [导入新文件] [批次历史]                  │
├─────────────────────────────────────────┤
│                                          │
│ 📥 上传FIP Excel文件                     │
│ ┌─────────────────────────────────────┐ │
│ │ 拖拽文件到此处或点击上传              │ │
│ └─────────────────────────────────────┘ │
│                                          │
│ 📋 FIP记录列表                           │
│                                          │
│ ┌────┬─────────┬────────┬──────┬─────┐ │
│ │FIP │Feature  │Priority│Owner │操作 │ │
│ ├────┼─────────┼────────┼──────┼─────┤ │
│ │001 │语音唤醒 │High💡  │张三  │[查看]│ │
│ │    │        ↑标注     │      │[标注]│ │
│ ├────┼─────────┼────────┼──────┼─────┤ │
│ │002 │导航功能 │Medium  │李四  │[查看]│ │
│ └────┴─────────┴────────┴──────┴─────┘ │
│                                          │
│ 💡标注说明：点击单元格可添加修改意见     │
│                                          │
│ [导出Excel（含标注）] [批量转Feature]   │
└─────────────────────────────────────────┘
```

### 交互2: Feature的SSTS拆解

```
┌─────────────────────────────────────────┐
│ Feature: 语音助手功能 v1.0.0             │
│ [概览] [设计文档] [SSTS列表⭐] [版本]   │
├─────────────────────────────────────────┤
│                                          │
│ 📋 SSTS列表                 [+ 创建SSTS] │
│                                          │
│ ┌────────────────────────────────────┐  │
│ │ SSTS-001 v1.0 语音识别引擎         │  │
│ │ 系统需求 | ASIL-B                  │  │
│ │ ├─ MR-001 声学模型训练             │  │
│ │ ├─ MR-002 信号预处理               │  │
│ │ └─ MR-003 实时识别服务             │  │
│ │ [详情] [创建MR] [版本管理]         │  │
│ └────────────────────────────────────┘  │
│                                          │
│ ┌────────────────────────────────────┐  │
│ │ SSTS-002 v1.0 语音合成引擎         │  │
│ │ 系统需求 | QM                      │  │
│ │ ├─ MR-004 TTS引擎集成              │  │
│ │ └─ MR-005 音频输出控制             │  │
│ │ [详情] [创建MR]                    │  │
│ └────────────────────────────────────┘  │
│                                          │
│ 统计：2个SSTS，5个MR                     │
└─────────────────────────────────────────┘
```

### 交互3: 创建MR - 选择Module

```
┌─────────────────────────────────────────┐
│ 创建模块需求（MR）                       │
│ SSTS: SSTS-001 语音识别引擎              │
├─────────────────────────────────────────┤
│                                          │
│ 1️⃣ 选择目标模块                         │
│                                          │
│ 产品线：智能座舱                         │
│ 产品：语音交互系统                       │
│                                          │
│ 📁 模块树                                │
│ ├─ 📦 语音识别模块（MOD-VOICE-001）      │
│ │  ├─ 声学模型（MOD-VOICE-001-1）✓      │
│ │  ├─ 信号处理（MOD-VOICE-001-2）       │
│ │  └─ 识别引擎（MOD-VOICE-001-3）       │
│ ├─ 📦 语音合成模块                       │
│ └─ 📦 对话管理模块                       │
│                                          │
│ 已选择：声学模型（MOD-VOICE-001-1）      │
│ 负责团队：AI算法团队                     │
│                                          │
│ [上一步] [下一步：填写MR信息]            │
└─────────────────────────────────────────┘
```

### 交互4: 工作票看板（按类型分色）

```
┌─────────────────────────────────────────────────────────────────┐
│ Sprint 2024-01 工作票看板                                        │
│ 筛选：[全部类型▼] [全部成员▼] [全部Module▼]                    │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│ Todo (12) │ In Progress (8) │ Review (5) │ Testing (3) │ Done(15)│
│           │                 │            │             │         │
│ ┌───────┐ │ ┌───────┐      │ ┌───────┐ │ ┌───────┐  │┌───────┐│
│ │🎯MR-1 │ │ │🎯MR-3 │      │ │🎯MR-5 │ │ │🎯MR-8 │  ││🎯MR-10││
│ │声学   │ │ │信号   │      │ │实时   │ │ │TTS    │  ││音频  ││
│ │模型   │ │ │预处理 │      │ │识别   │ │ │引擎   │  ││输出  ││
│ │12h ⚡ │ │ │8h     │      │ │16h    │ │ │10h    │  ││8h ✓ ││
│ │李四   │ │ │王五   │      │ │赵六   │ │ │孙七   │  ││李四  ││
│ └───────┘ │ └───────┘      │ └───────┘ │ └───────┘  │└───────┘│
│           │                 │            │             │         │
│ ┌───────┐ │ ┌───────┐      │            │             │┌───────┐│
│ │🐛Bug-1│ │ │⚠️Risk-1│      │            │             ││🔧Tech-1││
│ │唤醒   │ │ │依赖项 │      │            │             ││优化  ││
│ │失败   │ │ │未到位 │      │            │             ││响应  ││
│ │4h  🔴│ │ │-      │      │            │             ││6h ✓ ││
│ │张三   │ │ │PM     │      │            │             ││王五  ││
│ └───────┘ │ └───────┘      │            │             │└───────┘│
│           │                 │            │             │         │
│ 拖拽 →   │   拖拽 →        │  拖拽 →   │   拖拽 →   │         │
│           │                 │            │             │         │
└─────────────────────────────────────────────────────────────────┘

图例：
🎯 MR需求票  🐛 Bug票  ⚠️ 风险票  🔗 依赖票  🔧 技术任务票
⚡ 高优先级  🔴 阻塞
```

---

## 🔧 技术实现要点

### 1. 数据模型关系

```typescript
// 完整的数据关系链
Epic → Feature → SSTS → MR → Ticket

// Module独立管理（预先建立）
ProductLine → Product → Module

// FIP独立导入
FIPBatch → FIPRecord → Feature
```

### 2. 状态同步机制

```typescript
// 向上同步（子完成 → 父进度更新）
Ticket.Done → MR.progress++
All MR.Done → SSTS.Completed
All SSTS.Done → Feature.Completed
All Feature.Done → Epic.Completed

// 向下联动（父取消 → 子取消）
Epic.Cancelled → Feature.Cancelled
Feature.Cancelled → SSTS.Cancelled
```

### 3. 版本管理

```typescript
// Feature版本
Feature.version = "v1.0.0"
Feature.versionHistory = [...]

// SSTS版本
SSTS.version = "v1.0.0"
SSTS.versionHistory = [...]

// 版本快照
FeatureVersion.sstsSnapshot = ["SSTS-001-v1.0", ...]
```

---

## 📝 实施计划（重新规划）

### Phase 1: 需求池管理（第1-2周）
- [ ] Epic池管理页面
- [ ] FIP导入功能
- [ ] FIP标注系统
- [ ] FIP导出功能

### Phase 2: 产品线-特性需求（第3-4周）
- [ ] 产品线-产品树
- [ ] Feature管理
- [ ] 设计文档编辑器
- [ ] SSTS拆解界面

### Phase 3: 模块管理（第5周）
- [ ] 模块树管理
- [ ] Module CRUD
- [ ] 接口定义

### Phase 4: SSTS-MR拆解（第6周）
- [ ] SSTS详情
- [ ] MR创建（选择Module）
- [ ] 就绪检查

### Phase 5: 工作票系统（第7-8周）
- [ ] Ticket类型定义
- [ ] MR转Ticket
- [ ] Sprint Backlog
- [ ] 工作票看板
- [ ] 燃尽图

---

**设计者**: AI Assistant  
**版本**: V2.0  
**最后更新**: 2026-01-28
